---
phase: 01-migrate-todo-commands
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - bin/install.js
autonomous: false

must_haves:
  truths:
    - "Skill installs to ~/.claude/skills/kata-todo-management/ via bin/install.js"
    - "Natural language 'add todo' triggers skill"
    - "Natural language 'check todos' triggers skill"
    - "ADD operation creates todo file with correct frontmatter"
    - "CHECK operation presents pending todos with action options"
  artifacts:
    - path: "skills/kata-todo-management/SKILL.md"
      provides: "Complete todo management skill"
    - path: "skills/kata-todo-management/references/todo-format.md"
      provides: "Todo frontmatter schema"
    - path: "skills/kata-todo-management/references/actions.md"
      provides: "CHECK action workflows"
  key_links:
    - from: "bin/install.js"
      to: "skills/kata-todo-management/"
      via: "Copy to Claude config"
      pattern: "skills"
---

<objective>
Verify kata-todo-management skill installation and test natural language triggers for ADD and CHECK operations.

Purpose: Ensure the skill works end-to-end: installs correctly, triggers on natural language, and executes both operations.

Output: Verified skill installation with passing trigger tests and human-verified operation behavior.
</objective>

<execution_context>
@~/.claude/kata/workflows/execute-plan.md
@~/.claude/kata/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Skill to verify
@skills/kata-todo-management/SKILL.md
@skills/kata-todo-management/references/todo-format.md
@skills/kata-todo-management/references/actions.md

# Installer
@bin/install.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify installer copies skill directory</name>
  <files>bin/install.js</files>
  <action>
Check that bin/install.js already copies skills/ directory (should be in place from Phase 0):

1. Read bin/install.js
2. Verify `skills` is in the directories array being copied
3. If not present, add it to the copy list

Then run local install:
```bash
node bin/install.js --local
```

Verify skill was copied:
```bash
ls -la .claude/skills/kata-todo-management/
ls -la .claude/skills/kata-todo-management/references/
```

Expected:
- .claude/skills/kata-todo-management/SKILL.md exists
- .claude/skills/kata-todo-management/references/todo-format.md exists
- .claude/skills/kata-todo-management/references/actions.md exists
  </action>
  <verify>ls .claude/skills/kata-todo-management/SKILL.md && ls .claude/skills/kata-todo-management/references/*.md | wc -l shows 2</verify>
  <done>Skill directory installed to .claude/skills/ with SKILL.md and both reference files</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
kata-todo-management skill with ADD and CHECK operations:
- ADD: Captures todos with area/type inference, duplicate detection
- CHECK: Lists pending todos with 6 action options
  </what-built>
  <how-to-verify>
**Test ADD operation (natural language):**

1. In Claude Code, say: "add todo: Test the new todo skill"
2. Verify:
   - Skill triggers (not default behavior)
   - Todo file created in .planning/todos/pending/
   - Frontmatter has: created, title, area, type
   - Confirmation shown with file path

3. Check the file:
   ```bash
   cat .planning/todos/pending/$(ls -t .planning/todos/pending/ | head -1)
   ```

**Test CHECK operation (natural language):**

4. Say: "check todos"
5. Verify:
   - Shows pending todo count
   - Presents the test todo with options
   - AskUserQuestion appears with 6 choices

6. Select "mark complete"
7. Verify:
   - Todo moved to .planning/todos/done/
   - Next action shown

**Test duplicate detection:**

8. Say: "add todo: Test the new todo skill" (exact same title)
9. Verify:
   - Warning about duplicate
   - Todo NOT created (blocked)

**Expected behavior:**
- ADD infers area/type from context
- CHECK presents clear action options
- STATE.md pending count updates
  </how-to-verify>
  <resume-signal>Type "approved" if all verifications pass, or describe issues found</resume-signal>
</task>

</tasks>

<verification>
After both tasks:
- [ ] bin/install.js copies skills/ directory
- [ ] Local install places skill in .claude/skills/kata-todo-management/
- [ ] "add todo" natural language triggers skill
- [ ] ADD creates todo with correct frontmatter
- [ ] "check todos" natural language triggers skill
- [ ] CHECK shows pending list with action options
- [ ] Duplicate detection blocks exact title match
- [ ] STATE.md updates on add/complete
</verification>

<success_criteria>
- Skill installs correctly via bin/install.js
- Natural language "add todo" triggers skill (not default Claude behavior)
- Natural language "check todos" triggers skill
- ADD operation creates properly formatted todo file
- CHECK operation presents AskUserQuestion with 6 actions
- Mark complete moves todo to done/
- Duplicate detection prevents exact title duplicates
</success_criteria>

<output>
After completion, create `.planning/phases/01-migrate-todo-commands/01-03-SUMMARY.md`
</output>
