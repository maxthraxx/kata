---
phase: 01-migrate-todo-commands
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/kata-todo-management/SKILL.md
  - skills/kata-todo-management/references/todo-format.md
autonomous: true

must_haves:
  truths:
    - "User can say 'add todo' and skill captures the idea"
    - "Todo file created with correct frontmatter (created, title, area, type, files)"
    - "Area and type are inferred from context when not specified"
    - "Duplicate detection warns on exact title match or file overlap"
    - "STATE.md pending count updated after add"
  artifacts:
    - path: "skills/kata-todo-management/SKILL.md"
      provides: "Todo skill orchestrator with ADD operation"
      max_lines: 500
    - path: "skills/kata-todo-management/references/todo-format.md"
      provides: "Frontmatter schema, filename conventions, area/type inference"
  key_links:
    - from: "SKILL.md"
      to: "references/todo-format.md"
      via: "See reference for format details"
      pattern: "See.*todo-format.md"
    - from: "SKILL.md"
      to: ".planning/todos/pending/"
      via: "Write todo file"
      pattern: "\\.planning/todos/pending/"
    - from: "SKILL.md"
      to: ".planning/STATE.md"
      via: "Update pending count"
      pattern: "STATE\\.md"
---

<objective>
Create kata-todo-management skill with SKILL.md orchestrator and ADD operation for capturing todos.

Purpose: Migrate add-todo command functionality to skill-based invocation with natural language triggers and improved UX (area/type inference, duplicate detection).

Output: Skill directory with SKILL.md (<500 lines) and references/todo-format.md containing frontmatter schema.
</objective>

<execution_context>
@~/.claude/kata/workflows/execute-plan.md
@~/.claude/kata/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-migrate-todo-commands/01-RESEARCH.md

# Existing skill pattern to follow
@skills/kata-manageing-milestones/SKILL.md

# Example todo format
@.planning/todos/pending/2026-01-18-statusline-kata-project-info.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SKILL.md with operation detection and ADD workflow</name>
  <files>skills/kata-todo-management/SKILL.md</files>
  <action>
Create skill file following kata-manageing-milestones pattern:

1. **Frontmatter:**
   ```yaml
   ---
   name: kata-todo-management
   description: Use this skill to capture todos, review pending todos, or manage todo lifecycle. Triggers include "add todo", "capture idea", "note for later", "remember to", "todo:", "check todos", "pending todos", "review todos", "list todos", "show todos".
   ---
   ```

2. **Header and overview:**
   - Title: "Todo Management Orchestrator"
   - One-line: Handles todo capture (ADD) and review (CHECK) operations
   - "When to Use" section with trigger examples

3. **Operation Detection:**
   - ADD triggers: "add todo", "capture idea", "note for later", "remember to", "todo:" prefix
   - CHECK triggers: "check todos", "pending todos", "review todos", "what todos", "list todos", "show todos"
   - Route to appropriate workflow section

4. **ADD Operation Workflow:**
   - Step 1: Extract todo content (title from first sentence, body from description)
   - Step 2: Infer area from file paths mentioned or conversation context
     - planning | execution | tooling | ui | testing | docs | other
   - Step 3: Infer type from keywords
     - bug (bug, fix, broken, error)
     - refactor (refactor, cleanup, simplify)
     - docs (doc, readme, document)
     - chore (config, setup, install)
     - improvement (improve, enhance, better)
     - feature (default)
   - Step 4: Check for duplicates in .planning/todos/pending/
     - Exact title match = block with warning
     - File overlap = warn but allow
   - Step 5: Generate filename: {date}-{slug}.md
   - Step 6: Write todo file with frontmatter
   - Step 7: Update STATE.md pending count
   - Step 8: Confirm with next steps

5. **CHECK Operation placeholder:**
   - Just note "See Plan 01-02 for CHECK operation implementation"
   - This keeps file under 500 lines

6. **Reference to todo-format.md:**
   - Link to ./references/todo-format.md for frontmatter schema

Keep SKILL.md under 500 lines. Move detailed format specification to references/.
  </action>
  <verify>wc -l skills/kata-todo-management/SKILL.md shows < 500 lines</verify>
  <done>SKILL.md exists with frontmatter, operation detection, complete ADD workflow, and placeholder for CHECK</done>
</task>

<task type="auto">
  <name>Task 2: Create references/todo-format.md with schema and conventions</name>
  <files>skills/kata-todo-management/references/todo-format.md</files>
  <action>
Create reference file documenting todo file format:

1. **Frontmatter Schema:**
   ```yaml
   ---
   created: 2026-01-18T17:28    # ISO timestamp
   title: Short descriptive title # 5-10 words
   area: planning                  # planning | execution | tooling | ui | testing | docs | other
   type: feature                   # feature | bug | improvement | refactor | docs | chore
   files:                          # Optional: related file paths
     - path/to/file.ts
   ---
   ```

2. **Filename Convention:**
   - Pattern: {YYYY-MM-DD}-{slug}.md
   - Slug: lowercase, hyphens, alphanumeric only, max 50 chars
   - Example: 2026-01-18-add-authentication-to-api.md

3. **Area Values:**
   | Area | Description | Inferred from |
   |------|-------------|---------------|
   | planning | Roadmap, requirements, workflow design | planning/, ROADMAP, phase, milestone |
   | execution | Plan execution, task handling | execute, run, action |
   | tooling | Commands, skills, installer, integrations | commands/, skills/, workflows/, agents/ |
   | ui | Visual components, user interface | components/, pages/, ui/, style |
   | testing | Test infrastructure, verification | test/, spec/, *.test.* |
   | docs | Documentation, README, onboarding | *.md, readme, docs/ |
   | other | Anything not fitting above | (default) |

4. **Type Values:**
   | Type | Description | Inferred from keywords |
   |------|-------------|------------------------|
   | feature | New functionality | (default) |
   | bug | Something broken | bug, fix, broken, error |
   | improvement | Enhancement to existing | improve, enhance, better |
   | refactor | Code cleanup, no behavior change | refactor, cleanup, simplify |
   | docs | Documentation only | doc, readme, document |
   | chore | Configuration, dependencies | config, setup, install |

5. **Body Structure:**
   ```markdown
   ## Problem
   [Description of what needs to be addressed]

   ## Solution
   [Proposed approach or TBD if not yet known]
   ```

6. **Storage Locations:**
   - Pending: .planning/todos/pending/
   - Done: .planning/todos/done/
   - File location IS state (no status field needed)

7. **Examples section** with 2-3 real examples
  </action>
  <verify>cat skills/kata-todo-management/references/todo-format.md shows complete schema</verify>
  <done>todo-format.md exists with complete frontmatter schema, area/type tables, and examples</done>
</task>

</tasks>

<verification>
After both tasks:
- [ ] skills/kata-todo-management/ directory exists
- [ ] SKILL.md has correct frontmatter with trigger phrases
- [ ] SKILL.md is under 500 lines
- [ ] SKILL.md has operation detection routing
- [ ] ADD workflow has all 8 steps documented
- [ ] references/todo-format.md has complete schema
- [ ] References include area and type inference tables
</verification>

<success_criteria>
- SKILL.md created with proper frontmatter (name, description with triggers)
- Operation detection distinguishes ADD vs CHECK operations
- ADD workflow documented with inference, duplicate detection, file creation, STATE.md update
- todo-format.md contains complete frontmatter schema and conventions
- Total SKILL.md under 500 lines
</success_criteria>

<output>
After completion, create `.planning/phases/01-migrate-todo-commands/01-01-SUMMARY.md`
</output>
