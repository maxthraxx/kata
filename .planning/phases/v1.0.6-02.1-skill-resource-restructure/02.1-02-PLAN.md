---
phase: 02.1-skill-resource-restructure
plan: 02
type: execute
wave: 2
depends_on: ["02.1-01"]
files_modified:
  - skills/kata-executing-phases/SKILL.md
  - skills/kata-planning-phases/SKILL.md
  - skills/kata-starting-projects/SKILL.md
  - skills/kata-starting-milestones/SKILL.md
  - skills/kata-verifying-work/SKILL.md
  - skills/kata-completing-milestones/SKILL.md
  - skills/kata-discussing-phases/SKILL.md
  - skills/kata-mapping-codebases/SKILL.md
  - skills/kata-listing-phase-assumptions/SKILL.md
  - skills/kata-resuming-work/SKILL.md
autonomous: true

must_haves:
  truths:
    - "All skill SKILL.md files use relative @./references/ paths"
    - "No skills reference @~/.claude/kata/ paths"
    - "Path references match the files copied in Plan 01"
  artifacts:
    - path: "skills/kata-executing-phases/SKILL.md"
      provides: "Updated phase execution skill"
      contains: "@./references/ui-brand.md"
    - path: "skills/kata-starting-projects/SKILL.md"
      provides: "Updated project initialization skill"
      contains: "@./references/questioning.md"
  key_links:
    - from: "skills/kata-executing-phases/SKILL.md"
      to: "skills/kata-executing-phases/references/phase-execute.md"
      via: "@./references/phase-execute.md"
      pattern: "@\\./references/phase-execute\\.md"
---

<objective>
Update all skill SKILL.md files to use relative @./references/ paths instead of @~/.claude/kata/ paths.

Purpose: Enable skills to be self-contained by referencing their own bundled resources rather than shared resources that won't exist in plugin/npx distribution.

Output: All skills reference their own local resources with no external kata/ dependencies.
</objective>

<context>
@.planning/phases/v1.0.6-02.1-skill-resource-restructure/02.1-RESEARCH.md

**Path transformation pattern (from research):**

| Before (Source) | After (Source) |
|-----------------|----------------|
| `@~/.claude/kata/references/ui-brand.md` | `@./references/ui-brand.md` |
| `@~/.claude/kata/workflows/phase-execute.md` | `@./references/phase-execute.md` |
| `@~/.claude/kata/templates/project.md` | `@./references/project-template.md` |

Note: Templates are renamed with `-template` suffix, so the path must reflect this.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update @-references in high-traffic skills</name>
  <files>
    skills/kata-executing-phases/SKILL.md
    skills/kata-planning-phases/SKILL.md
    skills/kata-starting-projects/SKILL.md
    skills/kata-starting-milestones/SKILL.md
  </files>
  <action>
    Update the `<execution_context>` section in each SKILL.md to use relative paths:

    **kata-executing-phases/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/references/ui-brand.md
    @~/.claude/kata/references/planning-config.md
    @~/.claude/kata/workflows/phase-execute.md
    ```
    To:
    ```
    @./references/ui-brand.md
    @./references/planning-config.md
    @./references/phase-execute.md
    ```
    Also update any inline references in the body (line 282 mentions phase-execute.md).

    **kata-planning-phases/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/references/ui-brand.md
    ```
    To:
    ```
    @./references/ui-brand.md
    ```

    **kata-starting-projects/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/references/questioning.md
    @~/.claude/kata/references/ui-brand.md
    @~/.claude/kata/templates/project.md
    @~/.claude/kata/templates/requirements.md
    ```
    To:
    ```
    @./references/questioning.md
    @./references/ui-brand.md
    @./references/project-template.md
    @./references/requirements-template.md
    ```

    **kata-starting-milestones/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/references/questioning.md
    @~/.claude/kata/references/ui-brand.md
    @~/.claude/kata/templates/project.md
    @~/.claude/kata/templates/requirements.md
    ```
    To:
    ```
    @./references/questioning.md
    @./references/ui-brand.md
    @./references/project-template.md
    @./references/requirements-template.md
    ```
  </action>
  <verify>
    ```bash
    grep -n "@~/.claude/kata/" skills/kata-executing-phases/SKILL.md
    grep -n "@~/.claude/kata/" skills/kata-planning-phases/SKILL.md
    grep -n "@~/.claude/kata/" skills/kata-starting-projects/SKILL.md
    grep -n "@~/.claude/kata/" skills/kata-starting-milestones/SKILL.md
    ```
    All commands should return empty (no matches).
  </verify>
  <done>All 4 high-traffic skill SKILL.md files use relative @./references/ paths.</done>
</task>

<task type="auto">
  <name>Task 2: Update @-references in remaining skills</name>
  <files>
    skills/kata-verifying-work/SKILL.md
    skills/kata-completing-milestones/SKILL.md
    skills/kata-discussing-phases/SKILL.md
    skills/kata-mapping-codebases/SKILL.md
    skills/kata-listing-phase-assumptions/SKILL.md
    skills/kata-resuming-work/SKILL.md
  </files>
  <action>
    Update the `<execution_context>` section in each SKILL.md to use relative paths:

    **kata-verifying-work/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/workflows/verify-work.md
    @~/.claude/kata/templates/UAT.md
    ```
    To:
    ```
    @./references/verify-work.md
    @./references/UAT-template.md
    ```

    **kata-completing-milestones/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/workflows/milestone-complete.md
    @~/.claude/kata/templates/milestone-archive.md
    ```
    To:
    ```
    @./references/milestone-complete.md
    @./references/milestone-archive-template.md
    ```

    **kata-discussing-phases/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/workflows/phase-discuss.md
    @~/.claude/kata/templates/context.md
    ```
    To:
    ```
    @./references/phase-discuss.md
    @./references/context-template.md
    ```

    **kata-mapping-codebases/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/workflows/project-analyze.md
    ```
    To:
    ```
    @./references/project-analyze.md
    ```

    **kata-listing-phase-assumptions/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/workflows/phase-assumptions.md
    ```
    To:
    ```
    @./references/phase-assumptions.md
    ```

    **kata-resuming-work/SKILL.md:**
    Change:
    ```
    @~/.claude/kata/workflows/resume-project.md
    ```
    To:
    ```
    @./references/resume-project.md
    ```
    Also update any inline references in the body (line 30 mentions resume-project.md).
  </action>
  <verify>
    ```bash
    grep -rn "@~/.claude/kata/" skills/kata-verifying-work/SKILL.md
    grep -rn "@~/.claude/kata/" skills/kata-completing-milestones/SKILL.md
    grep -rn "@~/.claude/kata/" skills/kata-discussing-phases/SKILL.md
    grep -rn "@~/.claude/kata/" skills/kata-mapping-codebases/SKILL.md
    grep -rn "@~/.claude/kata/" skills/kata-listing-phase-assumptions/SKILL.md
    grep -rn "@~/.claude/kata/" skills/kata-resuming-work/SKILL.md
    ```
    All commands should return empty (no matches).
  </verify>
  <done>All 6 remaining skill SKILL.md files use relative @./references/ paths.</done>
</task>

<task type="auto">
  <name>Task 3: Verify no kata/ references remain in any skills</name>
  <files></files>
  <action>
    Run a comprehensive check across all skills to ensure no @~/.claude/kata/ references remain:

    ```bash
    grep -rn "@~/.claude/kata/" skills/
    ```

    If any matches found, update those files to use relative paths.
  </action>
  <verify>
    ```bash
    grep -rn "@~/.claude/kata/" skills/ | wc -l
    ```
    Should return 0.
  </verify>
  <done>No skills contain any @~/.claude/kata/ references.</done>
</task>

</tasks>

<verification>
All 10 skills with external dependencies now use relative @./references/ paths:
- grep -rn "@~/.claude/kata/" skills/ returns no matches
- Each skill's SKILL.md references match the files in its references/ subdirectory
</verification>

<success_criteria>
- [ ] All SKILL.md files updated with relative paths
- [ ] No @~/.claude/kata/ references remain in skills/
- [ ] Path names match the files copied in Plan 01 (including -template suffix)
- [ ] Inline body references also updated (not just execution_context)
</success_criteria>

<output>
After completion, create `.planning/phases/v1.0.6-02.1-skill-resource-restructure/02.1-02-SUMMARY.md`
</output>
