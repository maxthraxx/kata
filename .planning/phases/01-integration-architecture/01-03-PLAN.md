---
phase: 01-integration-architecture
plan: 03
type: execute
wave: 3
depends_on: ["01-01", "01-02"]
files_modified:
  - .planning/integrations/ARCHITECTURE.md
autonomous: false

must_haves:
  truths:
    - "Integration architecture is documented with clear extension points"
    - "Adding a new integration does not require modifying core GSD code"
    - "GitHub integration runs using the architecture (not hardcoded)"
    - "Extension pattern is proven by GitHub implementation"
  artifacts:
    - path: ".planning/integrations/ARCHITECTURE.md"
      provides: "Integration architecture documentation"
      contains: "## Extension Points"
      min_lines: 80
  key_links:
    - from: ".planning/integrations/ARCHITECTURE.md"
      to: ".claude/skills/"
      via: "documents skill creation pattern"
      pattern: "skills/"
    - from: ".planning/integrations/ARCHITECTURE.md"
      to: ".claude/hooks/"
      via: "documents hook wiring pattern"
      pattern: "hooks/"
---

<objective>
Document the integration architecture and verify that the pattern is complete and extensible.

Purpose: Create the architecture documentation that explains how to build new integrations. Then verify that all Phase 1 success criteria are met - the architecture works for GitHub and would work for any future integration.

Output: Architecture documentation at `.planning/integrations/ARCHITECTURE.md` and verified integration pattern.
</objective>

<execution_context>
@~/.claude/kata/workflows/execute-plan.md
@~/.claude/kata/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-integration-architecture/01-RESEARCH.md
@.planning/phases/01-integration-architecture/01-01-SUMMARY.md
@.planning/phases/01-integration-architecture/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create integration architecture documentation</name>
  <files>
    .planning/integrations/ARCHITECTURE.md
  </files>
  <action>
Create comprehensive architecture documentation for the integration system:

1. Create `.planning/integrations/ARCHITECTURE.md` with sections:

**Overview:**
- Purpose of the integration architecture
- Design principles: no core modification, event-driven, skill-based
- How integrations work with Claude Code native mechanisms

**Extension Points:**
- Hooks (`.claude/hooks/`) - Event detection and wiring
- Skills (`.claude/skills/`) - Integration capability packaging
- Registry (`.planning/integrations/`) - Integration management
- Templates - Output format customization

**Creating a New Integration:**
Step-by-step guide for creating an integration (use Linear as example):
1. Create skill directory: `.claude/skills/linear-integration/`
2. Create SKILL.md with frontmatter and capabilities
3. Create events.md mapping GSD events to Linear actions
4. Create templates for Linear objects (issues, projects)
5. Add config to `.planning/integrations/linear/config.json`
6. Register in `.planning/integrations/INTEGRATIONS.md`
7. No changes needed to commands/, agents/, or kata/

**Event System:**
- How hooks detect GSD events
- events.jsonl format and consumption
- Available events and their payloads

**GitHub Integration as Reference:**
- Point to `.claude/skills/github-integration/` as canonical example
- Explain how each component works together

**MCP Integration:**
- How integrations use MCP servers for API access
- GitHub MCP server: https://api.githubcopilot.com/mcp/
- Fallback to CLI tools when MCP unavailable
  </action>
  <verify>
    - `cat .planning/integrations/ARCHITECTURE.md` shows "## Extension Points" section
    - `grep -c "linear" .planning/integrations/ARCHITECTURE.md` shows Linear mentioned as example
    - `wc -l .planning/integrations/ARCHITECTURE.md` shows at least 80 lines
  </verify>
  <done>
    - ARCHITECTURE.md documents all extension points
    - Step-by-step guide for creating new integrations exists
    - GitHub integration referenced as canonical example
    - Architecture is self-documenting and discoverable
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify integration architecture completeness</name>
  <what-built>
Complete integration architecture with:
- Integration registry at .planning/integrations/INTEGRATIONS.md
- Hook infrastructure at .claude/hooks/ (hooks.json + on-gsd-event.sh)
- GitHub integration skill at .claude/skills/github-integration/
- Architecture documentation at .planning/integrations/ARCHITECTURE.md
  </what-built>
  <how-to-verify>
Verify Phase 1 success criteria are met:

1. **Integration architecture is documented with clear extension points**
   - Check: `.planning/integrations/ARCHITECTURE.md` exists and documents extension points
   - `cat .planning/integrations/ARCHITECTURE.md | head -50`

2. **An integration can hook into GSD workflow events**
   - Check: `.claude/hooks/hooks.json` configures PostToolUse hook
   - Check: `.claude/hooks/scripts/on-gsd-event.sh` is executable
   - `jq . .claude/hooks/hooks.json`
   - `ls -la .claude/hooks/scripts/on-gsd-event.sh`

3. **GitHub integration runs using this architecture (not hardcoded)**
   - Check: `.claude/skills/github-integration/SKILL.md` exists with frontmatter
   - Check: Integration registered in `.planning/integrations/INTEGRATIONS.md`
   - `cat .claude/skills/github-integration/SKILL.md | head -20`
   - `grep github .planning/integrations/INTEGRATIONS.md`

4. **Adding a new integration does not require modifying core GSD code**
   - Check: No files modified in commands/, agents/, or kata/
   - Verify ARCHITECTURE.md shows how to add Linear without core changes

5. **Pattern is extensible**
   - Review: Does the Linear example in ARCHITECTURE.md make sense?
   - Could you follow these steps to add a Jira integration?
  </how-to-verify>
  <resume-signal>Type "approved" if all criteria met, or describe specific issues to address</resume-signal>
</task>

</tasks>

<verification>
Phase 1 is complete when all success criteria from ROADMAP.md are verified:
1. Integration architecture is documented with clear extension points
2. An integration can hook into GSD workflow events
3. GitHub integration runs using this architecture (not hardcoded)
4. Adding a new integration does not require modifying core GSD code
</verification>

<success_criteria>
- ARCHITECTURE.md provides complete guide for creating integrations
- Human verifies all 4 Phase 1 success criteria are met
- No modifications to core Kata files (commands/, agents/, kata/)
- Integration pattern proven with GitHub, documented for future integrations
</success_criteria>

<output>
After completion, create `.planning/phases/01-integration-architecture/01-03-SUMMARY.md`
</output>
