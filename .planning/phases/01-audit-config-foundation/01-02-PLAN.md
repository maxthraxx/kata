---
phase: 01-audit-config-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - .planning/config.json
autonomous: true

must_haves:
  truths:
    - "Config file includes github namespace with defaults"
    - "Existing skills continue to work unchanged"
    - "Config reading pattern returns correct values"
  artifacts:
    - path: ".planning/config.json"
      provides: "Config with github namespace"
      contains: '"github"'
  key_links:
    - from: ".planning/config.json"
      to: "skills/kata-executing-phases/references/planning-config.md"
      via: "follows documented schema"
      pattern: '"enabled".*false'
---

<objective>
Add github namespace to config.json and verify integration.

Purpose: Implement the config schema defined in Plan 01 by updating the actual config file and verifying that the documented reading patterns work correctly.

Output:
- Updated `.planning/config.json` with `github.enabled: false` and `github.issueMode: "never"` defaults
- Verified config reading patterns work
</objective>

<execution_context>
@~/.claude/kata/references/execute-plan.md
@~/.claude/kata/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-audit-config-foundation/01-01-SUMMARY.md (if exists)

Reference files:
@skills/kata-executing-phases/references/planning-config.md
@.planning/config.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add github namespace to config.json</name>
  <files>.planning/config.json</files>
  <action>
Read the current `.planning/config.json` and add the github namespace.

Add after the `workflow` section:
```json
"github": {
  "enabled": false,
  "issueMode": "never"
}
```

Defaults rationale:
- `enabled: false` — Opt-in, no surprise GitHub API calls
- `issueMode: "never"` — Conservative default, user must explicitly enable issue creation

Ensure valid JSON (proper comma placement after workflow section).
  </action>
  <verify>cat .planning/config.json | grep -A3 '"github"' shows the namespace</verify>
  <done>config.json contains github namespace with correct defaults</done>
</task>

<task type="auto">
  <name>Task 2: Verify config reading patterns</name>
  <files></files>
  <action>
Test that the documented reading patterns from planning-config.md work correctly.

Run the config reading patterns and verify output:

```bash
# Test github.enabled reading
GITHUB_ENABLED=$(cat .planning/config.json 2>/dev/null | grep -o '"enabled"[[:space:]]*:[[:space:]]*[^,}]*' | grep -o 'true\|false' || echo "false")
echo "github.enabled = $GITHUB_ENABLED"

# Test github.issueMode reading
GITHUB_ISSUE_MODE=$(cat .planning/config.json 2>/dev/null | grep -o '"issueMode"[[:space:]]*:[[:space:]]*"[^"]*"' | grep -o '"[^"]*"$' | tr -d '"' || echo "never")
echo "github.issueMode = $GITHUB_ISSUE_MODE"
```

Expected output:
- `github.enabled = false`
- `github.issueMode = never`

If patterns don't work, adjust the config file format (not the patterns — patterns are the documented standard).
  </action>
  <verify>Both reading patterns return expected values (false, never)</verify>
  <done>Config reading patterns verified to work with new github namespace</done>
</task>

<task type="auto">
  <name>Task 3: Verify existing config reading still works</name>
  <files></files>
  <action>
Ensure adding the github namespace didn't break existing config reading.

Test existing patterns:
```bash
# Test pr_workflow reading
PR_WORKFLOW=$(cat .planning/config.json 2>/dev/null | grep -o '"pr_workflow"[[:space:]]*:[[:space:]]*[^,}]*' | grep -o 'true\|false' || echo "false")
echo "pr_workflow = $PR_WORKFLOW"

# Test mode reading
MODE=$(cat .planning/config.json 2>/dev/null | grep -o '"mode"[[:space:]]*:[[:space:]]*"[^"]*"' | grep -o '"[^"]*"$' | tr -d '"' || echo "yolo")
echo "mode = $MODE"

# Test workflow.research reading
RESEARCH=$(cat .planning/config.json 2>/dev/null | grep -o '"research"[[:space:]]*:[[:space:]]*[^,}]*' | grep -o 'true\|false' || echo "true")
echo "workflow.research = $RESEARCH"
```

Expected: All existing patterns return their current values without errors.
  </action>
  <verify>All existing config reading patterns return expected values</verify>
  <done>Existing config reading patterns verified to still work</done>
</task>

</tasks>

<verification>
- [ ] `.planning/config.json` contains `"github"` namespace
- [ ] `github.enabled` reads as `false`
- [ ] `github.issueMode` reads as `never`
- [ ] Existing `pr_workflow` reading still works
- [ ] Existing `mode` reading still works
- [ ] Existing `workflow.research` reading still works
- [ ] JSON is valid (no syntax errors)
</verification>

<success_criteria>
1. `.planning/config.json` includes `github.enabled` boolean toggle (CFG-01)
2. `.planning/config.json` includes `github.issueMode` with values `auto | ask | never` (CFG-02)
3. Kata commands can read config and branch on `github.enabled`
</success_criteria>

<output>
After completion, create `.planning/phases/01-audit-config-foundation/01-02-SUMMARY.md`
</output>
