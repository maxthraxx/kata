---
phase: 00-convert-commands-to-skills
plan: 06
type: execute
wave: 2
depends_on: ["00-01"]
files_modified:
  - skills/kata-managing-project-roadmap/SKILL.md
  - skills/kata-managing-project-roadmap/references/phase-operations.md
  - skills/kata-managing-project-roadmap/references/decimal-numbering.md
  - skills/kata-managing-project-roadmap/references/gap-planning.md
autonomous: true

must_haves:
  truths:
    - "User can invoke /kata-managing-project-roadmap skill from natural language"
    - "Skill handles phase-add, phase-insert, phase-remove, milestone-plan-gaps"
    - "Skill spawns kata-roadmapper sub-agent for roadmap operations"
  artifacts:
    - path: "skills/kata-managing-project-roadmap/SKILL.md"
      provides: "Roadmap management orchestrator skill"
      max_lines: 500
    - path: "skills/kata-managing-project-roadmap/references/phase-operations.md"
      provides: "Add, insert, remove phase workflows"
    - path: "skills/kata-managing-project-roadmap/references/decimal-numbering.md"
      provides: "Decimal phase numbering for urgent insertions"
  key_links:
    - from: "skills/kata-managing-project-roadmap/SKILL.md"
      to: "agents/kata-roadmapper.md"
      via: "Task tool spawn"
      pattern: "Task.*kata-roadmapper"
---

<objective>
Create the kata-managing-project-roadmap skill for roadmap operations.

Purpose: Handles adding phases, inserting urgent phases (decimal numbering), removing phases, and planning milestone gaps.

Output: skills/kata-managing-project-roadmap/ directory with SKILL.md and references/
</objective>

<execution_context>
@~/.claude/kata/workflows/execute-plan.md
@~/.claude/kata/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/00-convert-commands-to-skills/00-RESEARCH.md

# Skill-building methodology
@~/.claude/skills/building-claude-code-skills/SKILL.md
@~/.claude/skills/building-claude-code-skills/converting-slash-commands-to-skills.md

# Current implementation to extract workflow from
@commands/kata/phase-add.md
@commands/kata/phase-insert.md
@commands/kata/phase-remove.md
@commands/kata/milestone-plan-gaps.md
@agents/kata-roadmapper.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create kata-managing-project-roadmap skill with references</name>
  <files>
    skills/kata-managing-project-roadmap/SKILL.md
    skills/kata-managing-project-roadmap/references/phase-operations.md
    skills/kata-managing-project-roadmap/references/decimal-numbering.md
    skills/kata-managing-project-roadmap/references/gap-planning.md
  </files>
  <action>
Create the kata-managing-project-roadmap skill following /building-claude-code-skills methodology:

1. Create skills/kata-managing-project-roadmap/SKILL.md:
   - Frontmatter: name (kata-managing-project-roadmap), description (trigger-focused, 3rd person)
   - Description includes: "add phase", "insert phase", "remove phase", "roadmap", "urgent phase", "plan gaps", "fill gaps", "coverage gaps"
   - NO allowed-tools, model, agent, context fields
   - Core workflow (~350 lines max):
     * Determine operation from natural language (add, insert, remove, plan-gaps)
     * For ADD phase:
       - Determine insertion point (end of current milestone)
       - Gather phase goal and dependencies
       - Spawn kata-roadmapper to update ROADMAP.md
       - Create phase directory
     * For INSERT phase (urgent):
       - Identify target position (between existing phases)
       - Calculate decimal number (e.g., 2.1 between 2 and 3)
       - Mark as INSERTED in roadmap
       - Spawn kata-roadmapper for roadmap update
     * For REMOVE phase:
       - Verify phase not started
       - Confirm with user
       - Remove from ROADMAP.md
       - Clean up phase directory if exists
     * For PLAN-GAPS:
       - Run milestone audit
       - Identify uncovered requirements
       - Generate phase proposals for gaps
       - Offer to add proposed phases
   - Reference supporting files with relative paths

2. Create references/phase-operations.md:
   - Add phase workflow
   - Insert phase workflow
   - Remove phase workflow
   - Phase directory structure
   - ROADMAP.md update patterns

3. Create references/decimal-numbering.md:
   - When to use decimal phases (urgent insertions)
   - Numbering convention (X.1, X.2 between X and X+1)
   - INSERTED marker usage
   - Execution order (0 -> 0.1 -> 0.2 -> 1 -> 1.1 -> 2...)
   - Phase directory naming (00.1-name, not 0.1-name)

4. Create references/gap-planning.md:
   - Gap identification from audit
   - Phase proposal format
   - Gap-to-phase mapping
   - Batch phase creation
   - Integration with milestone audit

Extract content from:
- commands/kata/phase-add.md (has add workflow)
- commands/kata/phase-insert.md (has insert workflow, decimal numbering)
- commands/kata/phase-remove.md (has remove workflow)
- commands/kata/milestone-plan-gaps.md (has gap planning)
- agents/kata-roadmapper.md (has roadmap operations)
  </action>
  <verify>
    - ls skills/kata-managing-project-roadmap/ shows SKILL.md and references/ directory
    - wc -l skills/kata-managing-project-roadmap/SKILL.md shows less than 500 lines
    - grep "name: kata-managing-project-roadmap" skills/kata-managing-project-roadmap/SKILL.md returns match
    - grep "Task" skills/kata-managing-project-roadmap/SKILL.md shows sub-agent spawning
    - ls skills/kata-managing-project-roadmap/references/ shows 3 files
  </verify>
  <done>
    - SKILL.md exists with proper frontmatter (name, description only)
    - SKILL.md under 500 lines with workflow that spawns kata-roadmapper
    - 3 reference files exist with phase operations, decimal numbering, and gap planning
  </done>
</task>

</tasks>

<verification>
1. Skill structure follows /building-claude-code-skills methodology
2. SKILL.md has proper frontmatter (name and description only)
3. SKILL.md under 500 lines with workflow referencing ./references/*.md
4. All 3 reference files contain extracted content from command files
</verification>

<success_criteria>
- skills/kata-managing-project-roadmap/SKILL.md exists with orchestrator workflow
- skills/kata-managing-project-roadmap/references/ contains 3 reference files
- Skill handles add, insert, remove, and plan-gaps operations
</success_criteria>

<output>
After completion, create `.planning/phases/00-convert-commands-to-skills/00-06-SUMMARY.md`
</output>
