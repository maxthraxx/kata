---
phase: 01.3-phase-discuss-skill
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/kata-discussing-phase-context/SKILL.md
  - skills/kata-discussing-phase-context/references/discussion-protocol.md
  - skills/kata-discussing-phase-context/references/context-template.md
autonomous: true

must_haves:
  truths:
    - "Skill triggers on 'discuss phase N' prompts"
    - "Skill identifies domain-specific gray areas from phase analysis"
    - "Skill conducts adaptive questioning (4 questions per area)"
    - "Skill enforces scope guardrail (HOW not WHETHER)"
    - "Skill writes CONTEXT.md with captured decisions"
  artifacts:
    - path: "skills/kata-discussing-phase-context/SKILL.md"
      provides: "Main skill orchestrator workflow"
      max_lines: 500
    - path: "skills/kata-discussing-phase-context/references/discussion-protocol.md"
      provides: "Gray area identification and questioning guidelines"
    - path: "skills/kata-discussing-phase-context/references/context-template.md"
      provides: "CONTEXT.md output structure"
  key_links:
    - from: "SKILL.md"
      to: "references/*.md"
      via: "@-reference in workflow steps"
      pattern: "See.*references/"
---

<objective>
Create the `kata-discussing-phase-context` skill with full workflow logic for gathering implementation decisions before planning.

Purpose: Enable interactive phase discussions that capture user's vision and decisions, producing CONTEXT.md that downstream agents (researcher, planner) use to inform their work.

Output: Complete skill with SKILL.md (<500 lines) and references/ subdirectory for progressive disclosure.
</objective>

<execution_context>
@/Users/gannonhall/dev/oss/kata/kata/workflows/execute-plan.md
@/Users/gannonhall/dev/oss/kata/kata/templates/summary.md
</execution_context>

<context>
**Reference Implementation (SOURCE OF TRUTH):**
@/Users/gannonhall/dev/oss/get-shit-done/commands/gsd/phase-discuss.md

**Existing Skill Pattern:**
@/Users/gannonhall/dev/oss/kata/skills/kata-researching-phases/SKILL.md
@/Users/gannonhall/dev/oss/kata/skills/kata-researching-phases/references/discussion-protocol.md

**Project Context:**
@/Users/gannonhall/dev/oss/kata/.planning/PROJECT.md
@/Users/gannonhall/dev/oss/kata/.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SKILL.md with discuss workflow</name>
  <files>skills/kata-discussing-phase-context/SKILL.md</files>
  <action>
Create the skill file following existing kata skill patterns:

1. **Frontmatter** with:
   - name: kata-discussing-phase-context
   - description: Exhaustive trigger phrases including "discuss phase", "gather context", "phase discussion", "clarify implementation", "what should phase look like", "explore phase scope", "implementation decisions", "pre-planning discussion"

2. **When to Use** section listing trigger scenarios

3. **Workflow Overview** - single operation (Discuss) that:
   - Validates phase number
   - Checks for existing CONTEXT.md (offer update/view/skip)
   - Analyzes phase to identify gray areas (domain-specific, not generic)
   - Presents gray areas for multi-select (NO skip option)
   - Deep-dives each area (4 questions, then offer more/next)
   - Handles scope creep (redirect to deferred ideas)
   - Creates CONTEXT.md with sections matching discussed areas
   - Commits and offers next steps (research or plan)

4. **Key behaviors from GSD reference:**
   - Scope guardrail: "Discussion clarifies HOW to implement, not WHETHER to add more"
   - Domain-aware gray areas based on phase type (SEE/CALL/RUN/READ/ORGANIZE)
   - 4 questions per area then check for more
   - Capture deferred ideas (scope creep) without acting on them

5. **Keep under 500 lines** - move detailed guidance to references/

Reference the existing `kata-researching-phases/SKILL.md` for structure/formatting.
  </action>
  <verify>
    - File exists at skills/kata-discussing-phase-context/SKILL.md
    - wc -l shows under 500 lines
    - Contains proper frontmatter (name, description)
    - Contains workflow steps for validate, analyze, present, deep-dive, create
  </verify>
  <done>SKILL.md exists with complete discuss workflow, under 500 lines, proper frontmatter with exhaustive triggers</done>
</task>

<task type="auto">
  <name>Task 2: Create references/ subdirectory with protocol and template</name>
  <files>skills/kata-discussing-phase-context/references/discussion-protocol.md, skills/kata-discussing-phase-context/references/context-template.md</files>
  <action>
Create two reference files:

**references/discussion-protocol.md:**
- Philosophy: User = visionary, Claude = builder
- What to ask about (vision/implementation choices)
- What NOT to ask about (technical/architecture - researcher handles)
- Scope guardrail enforcement rules
- Gray area identification by domain type:
  - Something users SEE -> layout, density, interactions, states
  - Something users CALL -> responses, errors, auth, versioning
  - Something users RUN -> output format, flags, modes
  - Something users READ -> structure, tone, depth, flow
  - Something being ORGANIZED -> criteria, grouping, naming
- Question design guidelines (concrete options, not abstract)
- Deep-dive flow (4 questions, check, repeat or move on)
- Handling scope creep (redirect, capture, don't act)

**references/context-template.md:**
- CONTEXT.md structure with XML semantic containers:
  - `<domain>` - Phase Boundary section
  - `<decisions>` - Implementation Decisions + Claude's Discretion
  - `<specifics>` - Specific Ideas ("like X" references)
  - `<deferred>` - Deferred Ideas (captured scope creep)
- Example filled-in template
- Guidance on decision clarity for downstream agents

Mirror the pattern from `kata-researching-phases/references/discussion-protocol.md` but ensure it's complete for standalone use.
  </action>
  <verify>
    - ls skills/kata-discussing-phase-context/references/ shows both files
    - discussion-protocol.md contains gray area domain table
    - context-template.md contains XML structure example
  </verify>
  <done>References directory created with discussion-protocol.md and context-template.md providing full progressive disclosure</done>
</task>

</tasks>

<verification>
```bash
# Verify skill structure
ls -la skills/kata-discussing-phase-context/
ls -la skills/kata-discussing-phase-context/references/

# Verify SKILL.md under 500 lines
wc -l skills/kata-discussing-phase-context/SKILL.md

# Verify frontmatter
head -20 skills/kata-discussing-phase-context/SKILL.md

# Verify references exist
cat skills/kata-discussing-phase-context/references/discussion-protocol.md | head -30
cat skills/kata-discussing-phase-context/references/context-template.md | head -30
```
</verification>

<success_criteria>
- [ ] skills/kata-discussing-phase-context/SKILL.md exists (<500 lines)
- [ ] SKILL.md has proper frontmatter with exhaustive trigger phrases
- [ ] SKILL.md contains complete discuss workflow (validate -> analyze -> present -> deep-dive -> create)
- [ ] SKILL.md enforces scope guardrail
- [ ] references/discussion-protocol.md exists with gray area guidance
- [ ] references/context-template.md exists with CONTEXT.md structure
- [ ] Skill follows existing kata-* skill patterns
</success_criteria>

<output>
After completion, create `.planning/phases/01.3-phase-discuss-skill/01.3-01-SUMMARY.md`
</output>
