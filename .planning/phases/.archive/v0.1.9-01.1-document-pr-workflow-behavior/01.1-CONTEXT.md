# Phase 1.1: Document PR Workflow Behavior - Context

**Gathered:** 2026-01-22
**Status:** Ready for planning

<domain>
## Phase Boundary

Document the complete `pr_workflow` config behavior in `kata/references/planning-config.md`. This includes branch naming conventions, PR-per-phase workflow, release-milestone relationship, and workflow integration points.

This is documentation work — updating existing reference files, not creating new product features.

</domain>

<decisions>
## Implementation Decisions

### Branch Naming Convention
- Pattern: `{type}/v{milestone}-{phase}-{slug}`
- Examples: `feat/v0.1.9-01-plugin-structure-validation`, `fix/v0.1.9-01.1-document-pr-workflow`
- Prefix (`feat/`, `fix/`, `docs/`) follows existing commit type conventions — not special rules for decimals
- Branch timing: Create **after planning complete, before execution** (planning stays on main)

### PR Granularity & Lifecycle
- Granularity: **One PR per phase** (not per-plan, not per-milestone)
- Draft status: Open as **draft** at first commit, mark ready when phase execution complete
- PR title format: `v{milestone} Phase {N}: {Phase Name}` (e.g., "v0.1.9 Phase 1: Plugin Structure & Validation")
- PR body: Phase goal + bullet summary of each completed plan + test checklist from success criteria

### Release-Milestone Relationship
- **Release = milestone** — only one release per milestone, no mid-milestone releases
- **Milestone name IS the version** — v0.1.9 milestone produces v0.1.9 release (1:1 mapping)
- **Release trigger:** Merge to main with version bump (publish.yml detects version change)
- **Version bump timing:** User bumps manually before `/kata:milestone-complete`, workflow verifies it's done

### Workflow Integration Points
Document which commands check `pr_workflow` and what changes:

| Command            | Current Behavior       | With pr_workflow: true                 |
| ------------------ | ---------------------- | -------------------------------------- |
| project-new        | Asks about pr_workflow | Offers GitHub Actions scaffold         |
| settings           | Allows toggling        | Same                                   |
| phase-execute      | Commits to main        | **Create branch, open draft PR** (NEW) |
| milestone-complete | Creates local tag      | Skips tag, offers PR creation          |
| progress           | Shows phase status     | **Show PR status** (NEW)               |

### Claude's Discretion
- Exact wording and formatting in planning-config.md
- Whether to add diagrams or flowcharts
- How to organize the sections within `<pr_workflow_behavior>`

</decisions>

<specifics>
## Specific Ideas

- The existing `<pr_workflow_behavior>` section in planning-config.md is incomplete — needs full rewrite
- Current publish.yml behavior (publish on version change) is correct for this workflow
- phase-execute and progress need new integration (marked as NEW above) — document what SHOULD happen, implementation is separate phase

</specifics>

<deferred>
## Deferred Ideas

- **Test coverage for pr_workflow feature** — Use the new testing framework in `test/` to add coverage for pr_workflow behavior. This is implementation work, not documentation.
- **Implement phase-execute branch/PR creation** — The documentation describes what SHOULD happen; actual implementation is a separate phase.
- **Implement progress PR status** — Same as above.

</deferred>

---

*Phase: v0.1.9-01.1-document-pr-workflow-behavior*
*Context gathered: 2026-01-22*
